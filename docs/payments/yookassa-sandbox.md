# YooKassa Sandbox: тестовые ссылки оплаты

Эта памятка конспектирует раздел «Демо-магазин» из официального руководства YooKassa и поясняет, какую ссылку указывать в переменной `NEXT_PUBLIC_TEST_PAYMENT_URL`.

## Где искать ссылку тестового магазина

1. Зайдите в песочницу YooKassa: <https://sandbox.yookassa.ru/>. Учётная запись создаётся отдельно от боевого кабинета.
2. В левой колонке выберите **Интеграция → Демо-магазин**. Это раздел, описанный в руководстве YooKassa по адресу <https://yookassa.ru/developers/knowledge-base/testing/demo-shop>.
3. На странице откройте блок «Ссылка на оплату» и нажмите **«Скопировать»**. Сервис сформирует URL вида `https://sandbox.yookassa.ru/demo/payments/test-checkout?invoice=XXXXXXXXXXXX`, где `invoice` — сгенерированный идентификатор счёта.
4. Если нужно другое значение, нажмите «Создать новый платёж» — песочница выдаст свежий `invoice` и обновит ссылку. Собира́ть URL вручную из shopId не требуется: песочница сама подставляет корректные параметры.

## Как использовать в проекте

- Сохраните скопированную ссылку в `NEXT_PUBLIC_TEST_PAYMENT_URL` для окружений Development/Preview на Vercel или в `.env.local`.
- Опциональный ключ `NEXT_PUBLIC_TEST_PAYMENT_KEY` не обязателен для YooKassa: UI просто прокидывает его в параметр `testKey`, поэтому оставьте переменную пустой.
- Флаг `NEXT_PUBLIC_ENABLE_TEST_PAYMENT_REDIRECT` можно не трогать: по коду фронтенда кнопка «Оплатить (тест)» активируется автоматически, если URL задан и флаг не равен строке `'false'`. Установите `'false'`, чтобы временно скрыть кнопку без очистки ссылки.

## Проверка после обновления

1. Перезапустите dev-сервер (или задеплойте новую Preview сборку), чтобы переменная окружения попала в клиентский бандл.
2. Откройте карточку товара — кнопка «Оплатить (тест)» должна вести на скопированный URL и открывать платёжную форму YooKassa sandbox.
3. Если ссылка не работает, вернитесь в раздел «Демо-магазин» и сгенерируйте новый `invoice`: старые идентификаторы могут истечь через 30 минут.
